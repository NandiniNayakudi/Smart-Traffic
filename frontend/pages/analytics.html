<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - Smart Traffic Management System</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/components.css">
    <link rel="stylesheet" href="../css/dashboard.css">
    <link rel="stylesheet" href="../css/analytics.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <!-- Sidebar -->
    <aside class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-brand">
                <i class="fas fa-traffic-light"></i>
                <span>SmartTraffic</span>
            </div>
            <button class="sidebar-toggle" id="sidebarToggle">
                <i class="fas fa-bars"></i>
            </button>
        </div>
        
        <nav class="sidebar-nav">
            <ul class="nav-list">
                <li class="nav-item">
                    <a href="dashboard.html" class="nav-link">
                        <i class="fas fa-tachometer-alt"></i>
                        <span>Dashboard</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="monitoring.html" class="nav-link">
                        <i class="fas fa-chart-line"></i>
                        <span>Traffic Monitor</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="routes.html" class="nav-link">
                        <i class="fas fa-route"></i>
                        <span>Route Planning</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="signals.html" class="nav-link">
                        <i class="fas fa-traffic-light"></i>
                        <span>Signal Control</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="analytics.html" class="nav-link active">
                        <i class="fas fa-chart-bar"></i>
                        <span>Analytics</span>
                    </a>
                </li>
                <li class="nav-item">
                    <a href="settings.html" class="nav-link">
                        <i class="fas fa-cog"></i>
                        <span>Settings</span>
                    </a>
                </li>
            </ul>
        </nav>
        
        <div class="sidebar-footer">
            <div class="user-info" id="userInfo">
                <div class="user-avatar">
                    <i class="fas fa-user"></i>
                </div>
                <div class="user-details">
                    <div class="user-name" id="userName">Loading...</div>
                    <div class="user-role" id="userRole">Loading...</div>
                </div>
            </div>
            <button class="logout-btn" id="logoutBtn">
                <i class="fas fa-sign-out-alt"></i>
                <span>Logout</span>
            </button>
        </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content" id="mainContent">
        <!-- Top Bar -->
        <header class="top-bar">
            <div class="top-bar-left">
                <button class="mobile-menu-toggle" id="mobileMenuToggle">
                    <i class="fas fa-bars"></i>
                </button>
                <h1 class="page-title">Analytics & Reports</h1>
            </div>
            
            <div class="top-bar-right">
                <div class="analytics-controls">
                    <select class="form-select" id="timeRangeSelect">
                        <option value="24h">Last 24 Hours</option>
                        <option value="7d" selected>Last 7 Days</option>
                        <option value="30d">Last 30 Days</option>
                        <option value="90d">Last 90 Days</option>
                    </select>
                    <button class="btn btn-primary" id="generateReport">
                        <i class="fas fa-file-alt"></i>
                        Generate Report
                    </button>
                </div>
                
                <button class="theme-toggle" id="themeToggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </header>

        <!-- Analytics Content -->
        <div class="analytics-content">
            <!-- Key Metrics Section -->
            <section class="metrics-section">
                <div class="metrics-grid">
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3>Traffic Efficiency</h3>
                            <i class="fas fa-tachometer-alt"></i>
                        </div>
                        <div class="metric-value">
                            <span class="value" id="trafficEfficiency">94.2%</span>
                            <span class="change positive">
                                <i class="fas fa-arrow-up"></i>
                                +2.1%
                            </span>
                        </div>
                        <div class="metric-description">
                            Compared to last period
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3>Average Wait Time</h3>
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="metric-value">
                            <span class="value" id="avgWaitTime">2.3 min</span>
                            <span class="change positive">
                                <i class="fas fa-arrow-down"></i>
                                -15.2%
                            </span>
                        </div>
                        <div class="metric-description">
                            Reduction from optimization
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3>Fuel Savings</h3>
                            <i class="fas fa-leaf"></i>
                        </div>
                        <div class="metric-value">
                            <span class="value" id="fuelSavings">18.7%</span>
                            <span class="change positive">
                                <i class="fas fa-arrow-up"></i>
                                +3.4%
                            </span>
                        </div>
                        <div class="metric-description">
                            Environmental impact
                        </div>
                    </div>
                    
                    <div class="metric-card">
                        <div class="metric-header">
                            <h3>Signal Optimization</h3>
                            <i class="fas fa-traffic-light"></i>
                        </div>
                        <div class="metric-value">
                            <span class="value" id="signalOptimization">87.5%</span>
                            <span class="change positive">
                                <i class="fas fa-arrow-up"></i>
                                +5.8%
                            </span>
                        </div>
                        <div class="metric-description">
                            Signals running optimally
                        </div>
                    </div>
                </div>
            </section>

            <!-- Charts Section -->
            <section class="analytics-charts-section">
                <div class="charts-grid">
                    <div class="chart-card large">
                        <div class="chart-header">
                            <h3>Traffic Flow Analysis</h3>
                            <div class="chart-controls">
                                <div class="chart-tabs">
                                    <button class="chart-tab active" data-chart="hourly">Hourly</button>
                                    <button class="chart-tab" data-chart="daily">Daily</button>
                                    <button class="chart-tab" data-chart="weekly">Weekly</button>
                                </div>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="trafficFlowAnalysisChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Peak Hours Distribution</h3>
                            <div class="chart-controls">
                                <button class="btn btn-sm btn-secondary" id="refreshPeakHours">
                                    <i class="fas fa-sync-alt"></i>
                                </button>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="peakHoursChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Route Efficiency</h3>
                            <div class="chart-controls">
                                <select class="form-select" id="routeSelect">
                                    <option value="all">All Routes</option>
                                    <option value="main">Main Corridors</option>
                                    <option value="secondary">Secondary Roads</option>
                                </select>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="routeEfficiencyChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="chart-card">
                        <div class="chart-header">
                            <h3>Incident Impact</h3>
                            <div class="chart-controls">
                                <span class="chart-info">Last 30 days</span>
                            </div>
                        </div>
                        <div class="chart-container">
                            <canvas id="incidentImpactChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Insights Section -->
            <section class="insights-section">
                <div class="insights-header">
                    <h3>
                        <i class="fas fa-lightbulb"></i>
                        AI-Powered Insights
                    </h3>
                    <button class="btn btn-secondary" id="refreshInsights">
                        <i class="fas fa-sync-alt"></i>
                        Refresh Insights
                    </button>
                </div>
                
                <div class="insights-grid">
                    <div class="insight-card priority-high">
                        <div class="insight-icon">
                            <i class="fas fa-exclamation-triangle"></i>
                        </div>
                        <div class="insight-content">
                            <h4>High Priority</h4>
                            <p>Main Street intersection shows 23% increase in congestion during evening rush. Consider extending green light duration by 15 seconds.</p>
                            <div class="insight-actions">
                                <button class="btn btn-sm btn-primary">Apply Suggestion</button>
                                <button class="btn btn-sm btn-secondary">View Details</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="insight-card priority-medium">
                        <div class="insight-icon">
                            <i class="fas fa-info-circle"></i>
                        </div>
                        <div class="insight-content">
                            <h4>Medium Priority</h4>
                            <p>Tech District shows optimal performance with current signal timing. No changes recommended at this time.</p>
                            <div class="insight-actions">
                                <button class="btn btn-sm btn-secondary">View Analysis</button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="insight-card priority-low">
                        <div class="insight-icon">
                            <i class="fas fa-chart-line"></i>
                        </div>
                        <div class="insight-content">
                            <h4>Optimization Opportunity</h4>
                            <p>University Avenue could benefit from adaptive signal timing during weekend hours to improve pedestrian flow.</p>
                            <div class="insight-actions">
                                <button class="btn btn-sm btn-primary">Schedule Implementation</button>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Reports Section -->
            <section class="reports-section">
                <div class="reports-header">
                    <h3>
                        <i class="fas fa-file-alt"></i>
                        Generated Reports
                    </h3>
                    <div class="reports-controls">
                        <button class="btn btn-primary" id="createCustomReport">
                            <i class="fas fa-plus"></i>
                            Create Custom Report
                        </button>
                    </div>
                </div>
                
                <div class="reports-table">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Report Name</th>
                                <th>Type</th>
                                <th>Generated</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="reportsTableBody">
                            <tr>
                                <td>Weekly Traffic Summary</td>
                                <td>Automated</td>
                                <td>2 hours ago</td>
                                <td><span class="status-badge optimal">Ready</span></td>
                                <td>
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i>
                                        Download
                                    </button>
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-eye"></i>
                                        View
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>Signal Performance Analysis</td>
                                <td>Custom</td>
                                <td>1 day ago</td>
                                <td><span class="status-badge optimal">Ready</span></td>
                                <td>
                                    <button class="btn btn-sm btn-secondary">
                                        <i class="fas fa-download"></i>
                                        Download
                                    </button>
                                    <button class="btn btn-sm btn-primary">
                                        <i class="fas fa-eye"></i>
                                        View
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <td>Monthly Efficiency Report</td>
                                <td>Automated</td>
                                <td>3 days ago</td>
                                <td><span class="status-badge warning">Processing</span></td>
                                <td>
                                    <button class="btn btn-sm btn-secondary" disabled>
                                        <i class="fas fa-clock"></i>
                                        Pending
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
        </div>
    </main>

    <!-- Scripts -->
    <script src="../js/main.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/dashboard.js"></script>
    <script src="../js/analytics.js"></script>
</body>
</html>
